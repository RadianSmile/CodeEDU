<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Untitled Document</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
<script src="src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="../processing/minim.js"></script>
<script src="../processing/processing.js"></script> 


<style>
#editor-container {
	position:relative;
	margin:50px;
	height:3000px;
	
}
 #editor { 
        margin: 0;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
    }
</style>
<link href="../../css.css" rel="stylesheet"> 
</head>

<body>
<form id="submitAssign">
	<input id="link" placeholder="請貼入作業pde檔連結" style="width:400px; padding:10px;"><br>
	<input id="submit" type="button" value="送出作業" style="padding:10px;">
</form>

<div id="editor-container">
	<div id="editor">

	</div>
</div>
<canvas data-processing-sources="http://radiansmile.github.io/CodeEDU/final_11/final_11.pde"></canvas>

<script type="text/javascript">
$("#submit").on('click',function(){
    toSubmit($('#link').val());
		console.log($('#link').val());
    return false;
});

</script>

<script>
    var callback = function (data, status, xhr) {
			
        //data will be the xml returned from the server
        if (status == 'success') {
					console.log (data);
            var editor = ace.edit("editor");
            //apparently, only modes supported are 'html', 'javascript' & 'text'
  		      //editor.setTheme("ace/theme/twilight");
	editor.getSession().setTabSize(4);
	document.getElementById('editor').style.fontSize='16px';
		        editor.getSession().setMode("ace/mode/java");
            editor.setValue(data);
					
						
	function setEditorHeight(){
		var lastLine = $("#editor .ace_gutter-cell:last");
		var neededHeight = lastLine.position().top + lastLine.outerHeight();
		$("#editor-container").height(neededHeight);
	}
		//setEditorHeight();
	//$(window).on('resize', setEditorHeight);
						
        }
    };
    //using jQuery to fire off an ajax request to load the xml,
    //using our callback as the success function
    function toSubmit (url){
        $.ajax(
            {
                url : "http://codedu.com/getcode.php" ,
							 		type: "POST",
									data:{url:url},
                dataType : 'text', //explicitly requesting the xml as text, rather than an xml document
                success : callback
            }
        );
    }


</script>
</body>
</html>
