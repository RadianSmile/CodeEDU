<!DOCTYPE html>
<head>
<link rel="icon" type="image/png" href="include/icon.png" />
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.19.min.js"></script>
<link href="css/all.css" rel="stylesheet" />
<script src="js/all.js"></script>

<title>ＦＢ</title>
</head>
<body>
<div id="fb-root"></div>
<script>
   function logout () {   
    FB.logout(function(response) {
       console.log ("Logout");
			 alert("已經成功登出囉~");
    });

    }
function fb_login () {
	FB.login(function(response){
		//console.log(response);
		var u = response.authResponse.userID;
		var q = new Parse.Query(Parse.User);
		q.equalTo("uid",u);
		q.first().then(function(s){	
			if(typeof(s) !== "undefined"){
				Parse.FacebookUtils.logIn(null,{success:function(u){
					if (!u.existed()) {
						//這裡理論上不能發生！
						alert ("我幫你註冊了，但好像有哪裡不太對噢");
						document.location="signup.html";
					}else{
		//asSs				alert("登入成功!");
						document.location ="dashboard.html";	
					}
				}, error : function(){
					alert("請重新整理頁面再試一次");
					console.log(alert(error.message));
				}});	
					
			}else{
				
				alert ("你尚未註冊，系統將自動跳轉註冊頁面。");
				document.location="signup.html";
			}
			
		},function(e){
			console.log(e.message);	
		});
	});
}



</script>


<!-- Button trigger modal -->
<button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#loginModal">
  Login
</button>

<!-- Modal -->
<div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
        

<div class="btn btn-primary"   onclick="fb_login();">
  以FB帳號登入
</div>
<a class="btn btn-default" href="signup.html">
  課程學生註冊
</a>




<div id="status">
</div>

<div id="result"></div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
</body>
